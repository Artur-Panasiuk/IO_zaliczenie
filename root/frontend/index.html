<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Przyklad Fetch API i Petite Vue</title>
</head>
<body>
    <header>
      <div>
        <img src="./assets/images/logo_temp.png" alt="logo">
      </div>
      <nav>
        <div id="hamburgerMenu" v-scope>
          <div v-if="userTypeId == 0"> <!--niezalogowany-->
            <button  @click="pageIndex = 1">Zaloguj</button>
            <button  @click="pageIndex = 4">Koszyk</button>
          </div>
          <div v-if="userTypeId == 1"> <!--zalogowany-->
            <button  @click="pageIndex = 4">Koszyk</button>
            <button  @click="zalogowany_wyloguj">Wyloguj</button>
          </div>
          <div v-if="userTypeId == 2"> <!--dostawca-->
            <button  @click="dostawca_zamowienia">Zamówienia</button>
            <button  @click="dostawca_ustawienia">Ustawienia</button>
            <button  @click="dostawca_wyloguj">Wyloguj</button>
          </div>
          <div v-if="userTypeId == 3"> <!--restaurator-->
            <button  @click="restaurator_menu">Zamówienia</button>
            <button  @click="restaurator_zamowienia">Zamówienia</button>
            <button  @click="restaurator_oceny">Ustawienia</button>
            <button  @click="restaurator_wyloguj">Wyloguj</button>
          </div>
        </div>
      </nav>
    </header>
    <main id="mainContent" v-scope>
        <div v-if="pageIndex == 0"> <!--Wprowadź miasto-->
            <form @submit.prevent="submitCity">
                <label for="InputCity">Wprowadź nazwę miasta</label>
                <input type="text" id="InputCity" v-model="InputCity">
                <button type="submit">Szukaj</button>
            </form>
        </div>
        <div v-if="pageIndex == 1"> <!--Zaloguj-->
          <form @submit.prevent="logowanie">
            <p>Zaloguj się</p>
            <input type="text" placeholder="Login" v-model="login">
            <input type="text" placeholder="Hasło" v-model="haslo">
            <button type="submit">Zaloguj</button>
          </form>
        </div>
        <div v-if="pageIndex == 2"><!--Lista Restauracji-->
            <ul>
              <li v-for="restaurant in restaurantsList" :key="restaurant.id">
                <button id="restaurantListContainerButton">
                  <img src="" alt="logo">
                  {{restaurant.name}}
                </button>
              </li>
            </ul>
        </div>
        <div v-if="pageIndex == 3"><!--Lista produktów restauracji-->
            <ul>
              <li v-for="item in itemList" :key="item.id">
                <button id="itemInList">
                    {{item.name}}
                    {{item.price}}
                    <p>Dodaj</p>
                </button>
              </li>
            </ul>
        </div>
        <div v-if="pageIndex == 4"><!--koszyk-->
          <p>Koszyk</p>
          <form @submit.prevent="koszyk">
            <ul>
              <li v-for="item in koszykList" :key="item.id">
                {{item.name}}
                {{item.price}}
              </li>
            </ul>
            <label for="DeliveryCity">Miasto:</label>
            <input type="text" id="DeliveryCity" v-model="DeliveryCity">

            <label for="DeliveryStreet">Ulica:</label>
            <input type="text" id="DeliveryStreet" v-model="DeliveryStreet">

            <label for="DeliveryName">Imię: </label>
            <input type="text" id="DeliveryName" v-model="DeliveryName">

            <label for="DeliverySurname">Nazwisko: </label>
            <input type="text" id="DeliverySurname" v-model="DeliverySurname">

            <label for="DeliveryPhone">Nr. tel.:</label>
            <input type="text" id="DeliveryPhone" v-model="DeliveryPhone">


            <label for="blik">BLIK</label>
            <input type="radio" id="blik" value="blik">

            <label for="karta">Karta</label>
            <input type="radio" id="karta" value="karta">

            <label for="gotowka">Gotówka</label>
            <input type="radio" id="gotowka" value="gotowka">


            <label for="regulamin">Akceptuję regulamin serwisu Smacznego</label>
            <input type="checkbox" id="regulamin">

            <label for="emailSpam">Chcę otrzymywać spam w swojej skrzynce email</label>
            <input type="checkbox" id="emailSpam">


            <button type="submit">Zapłać</button>
          </form>
        </div>
        <div v-if="pageIndex == 5"><!--Status Zamówienia-->
            Status Zamówienia: {{state.OrderStatus}}
        </div>
        <div v-if="pageIndex == 6"><!--Lista dostaw-->
          <ul>
            <li v-for="delivery in delivers" :key="delivery.id">
              Zamówienie nr: {{delivery.id}}
              <button>Przyjmij</button>
            </li>
          </ul>
        </div>
        <div v-if="pageIndex == 7"><!--Ustawienia dostawcy-->

        </div>
        <div v-if="pageIndex == 8"><!--Menu restauracji-->
          <ul>
            <li v-for="item in itemList" :key="item.id">
                  {{item.name}}
                  {{item.price}}
            </li>
          </ul>
        </div>
        <div v-if="pageIndex == 9"><!--Zamówienia restauracji-->
          <ul>
            <li v-for="order in restaurantOrderList" :key="orders.id">
              Zamówienie nr: {{order.id}}
              Dostawca: {{order.couriersid}}
              <button id="printOrder">Drukuj</button>
            </li>
          </ul>
        </div>
        <div v-if="pageIndex == 10"><!--Oceny restauracji-->
          <p>Oceny</p>
          <ul>
            <li v-for="review in reviewList" :key="review.Id">
              {{review.rating}} - {{review.comment}}
            </li>
          </ul>
        </div>
    </main>
    <footer>

    </footer>

      <script type="module">
        import { createApp, reactive } from 'https://unpkg.com/petite-vue?module'

        createApp({
          userTypeId: 0,
          pageIndex: 0,
          orderStatus: "NO",
          InputCity: '',
          restaurantsList: null,
          submitCity(){ //CITY SEARCH-----------------
            fetch('../backend/restaurants.php', {
              method: 'POST',
              body: this.InputCity
            })
            .then(res => res.json())
            .then(data => {
              this.restaurantsList = data;
              this.pageIndex = 2 //LIST RESTAURACJI
            })
            .catch(err => {
              console.log('Error:', err)
            })
          },//ITEMS SEARCH----------------------------
          getItems(){
            fetch('../backend/items.php', {
              method: 'POST',
              body: cityText
            })
          }

        }).mount()
      </script>
</body>
</html>